import{t as Jt,a as Tt}from"../chunks/a5WjkIqk.js";import{h as St,p as Ut,ap as P,Y as Wt,G as zt,aq as $t,s as l,c as h,t as Xt,K as t,a as Zt,W as w,ar as Kt,r as v}from"../chunks/Dbtdn9f7.js";import{s as Qt}from"../chunks/gfzC0wA8.js";import{s as rt}from"../chunks/DAD-lUWQ.js";import{s as It,r as $}from"../chunks/DCfzdB8P.js";import{d as Vt,e as Pt}from"../chunks/xKwX_C3Q.js";import{a as I,J as te}from"../chunks/BzzBhkj3.js";import{b as ot,F as ee}from"../chunks/DizoNBs4.js";import{b as Ht}from"../chunks/CF_zwyUB.js";import{o as ae}from"../chunks/i5uILAt2.js";import{t as Rt,w as ie}from"../chunks/4eif3qM-.js";function At(i,f=!1){var r=f?" !important;":";",p="";for(var s in i){var m=i[s];m!=null&&m!==""&&(p+=" "+s+": "+m+r)}return p}function lt(i){return i[0]!=="-"||i[1]!=="-"?i.toLowerCase():i}function ne(i,f){if(f){var r="",p,s;if(Array.isArray(f)?(p=f[0],s=f[1]):p=f,i){i=String(i).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var m=!1,S=0,a=!1,b=[];p&&b.push(...Object.keys(p).map(lt)),s&&b.push(...Object.keys(s).map(lt));var _=0,n=-1;const H=i.length;for(var d=0;d<H;d++){var u=i[d];if(a?u==="/"&&i[d-1]==="*"&&(a=!1):m?m===u&&(m=!1):u==="/"&&i[d+1]==="*"?a=!0:u==='"'||u==="'"?m=u:u==="("?S++:u===")"&&S--,!a&&m===!1&&S===0){if(u===":"&&n===-1)n=d;else if(u===";"||d===H-1){if(n!==-1){var x=lt(i.substring(_,n).trim());if(!b.includes(x)){u!==";"&&d++;var D=i.substring(_,d).trim();r+=" "+D+";"}}_=d+1,n=-1}}}}return p&&(r+=At(p)),s&&(r+=At(s,!0)),r=r.trim(),r===""?null:r}return i==null?null:String(i)}function st(i,f={},r,p){for(var s in r){var m=r[s];f[s]!==m&&(r[s]==null?i.style.removeProperty(s):i.style.setProperty(s,m,p))}}function re(i,f,r,p){var s=i.__style;if(St||s!==f){var m=ne(f,p);(!St||m!==i.getAttribute("style"))&&(m==null?i.removeAttribute("style"):i.style.cssText=m),i.__style=f}else p&&(Array.isArray(p)?(st(i,r==null?void 0:r[0],p[0]),st(i,r==null?void 0:r[1],p[1],"important")):st(i,r,p));return p}const oe=""+new URL("../workers/XcodeNinePatchRenderer-DSIeq7jB.js",import.meta.url).href;var le=(i,f)=>f(i,"left"),se=(i,f)=>f(i,"right"),pe=(i,f)=>f(i,"top"),ce=(i,f)=>f(i,"bottom"),fe=Jt(`<main class="container" style="max-width: 980px; margin: 24px auto; padding: 16px;"><h1 style="font: 600 20px/1.2 system-ui, -apple-system, sans-serif; margin-bottom: 16px;">iOS Nine-Patch Resizer (OffscreenCanvas + Comlink)</h1> <section style="display: grid; grid-template-columns: 1fr; gap: 12px; margin-bottom: 12px;"><label>PNG File <input name="xcode_png_ninepatch_input" type="file" accept="image/png"></label> <div style="display:flex; gap:12px; flex-wrap:wrap;"><label>Source Scale <select name="source_scale"><option>1x</option><option>2x</option><option>3x</option></select></label> <label>Resizing Mode <select name="resizing_mode"><option>9-part</option><option>3-part-horizontal</option><option>3-part-vertical</option></select></label> <label>Center Mode <select name="center_mode"><option>stretch</option><option>tile</option></select></label> <button>Export ResizingInfo</button></div></section> <section><canvas width="1" height="1"></canvas> <div style="margin-top:8px; font: 12px/1.3 ui-monospace, SFMono-Regular, Menlo, monospace;"> </div> <fieldset style="
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 8px 16px;
    border: 1px solid #ccc;
    border-radius: 8px;
    padding: 8px 12px;
  "><label style="display: flex; flex-direction: column;">Left <input name="left_inset" type="number" min="0" step="1"></label> <label style="display: flex; flex-direction: column;">Right <input name="right_inset" type="number" min="0" step="1"></label> <label style="display: flex; flex-direction: column;">Top <input name="top_inset" type="number" min="0" step="1"></label> <label style="display: flex; flex-direction: column;">Bottom <input name="bottom_inset" type="number" min="0" step="1"></label></fieldset></section> <section><h6>Preview</h6> <fieldset style=" display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 8px 16px;
    border: 1px solid #ccc;
    border-radius: 8px;
    padding: 8px 12px;"><label>Preview Width <input type="number" name="preview_width"></label> <label>Preview Height <input type="number" name="preview_height"></label></fieldset> <canvas></canvas></section></main>`);function ye(i,f){Ut(f,!0);let r,p=P(3),s=P("9-part"),m=P("stretch"),S=null,a=P(Wt({left:0,right:0,top:0,bottom:0})),b=!1,_=null,n=null,d,u=Wt({w:10,h:10}),x=P(1),D=.5,H=8;function Ct(e){e.preventDefault();const o=e.deltaY>0?-.1:.1;w(x,Math.min(H,Math.max(D,t(x)+o)),!0),console.log("adasdfasdf",e,t(x))}ae(()=>{_==null||_.terminate(),_=null,n=null});async function Bt(){if(n)return n;const e=new Worker(oe,{type:"module"});_=e,n=ie(e);const o=r.transferControlToOffscreen();return await n.attach(Rt(o,[o])),n}async function Nt(e){var yt;const g=(yt=e.target.files)==null?void 0:yt[0];if(!g)return;if(g.type!=="image/png"){alert("Please select a PNG file");return}S=g.name.replace(/@[\dx]+(?=\.png$)|\.png$/g,""),g.name.endsWith("@3x.png")?w(p,3):g.name.endsWith("@2x.png")?w(p,2):g.name.endsWith("@1x.png")&&w(p,1);const c=await createImageBitmap(g,{colorSpaceConversion:"none",premultiplyAlpha:"premultiply"}),W=await Bt();await W.setSource(Rt(c,[c]),t(p));const y=await W.getState();w(a,{left:Math.round(y.canvasW*.2),right:Math.round(y.canvasW*.2),top:Math.round(y.canvasH*.2),bottom:Math.round(y.canvasH*.2)},!0),u.h=y.canvasH,u.w=y.canvasW,await W.setInsets(rt(t(a)),"right","bottom"),await z();const Gt=t(x);w(x,.1),await Kt(),w(x,Gt,!0)}async function z(){var o;if(!n)return;let e=await n.createBitmap(d.width,d.height);(o=d.getContext("bitmaprenderer"))==null||o.transferFromImageBitmap(e)}async function Ot(){if(!n)return;await n.setScale(t(p));const e=await n.getState();t(a).left=Math.min(t(a).left,e.canvasW-1),t(a).right=Math.min(t(a).right,e.canvasW-1),t(a).top=Math.min(t(a).top,e.canvasH-1),t(a).bottom=Math.min(t(a).bottom,e.canvasH-1),await n.setInsets(rt(t(a)),"right","bottom"),await z()}function pt(e){const o=r.getBoundingClientRect(),g=Math.max(0,Math.min(e.clientX-o.left,o.width)),c=Math.max(0,Math.min(e.clientY-o.top,o.height)),W=r.width/o.width,y=r.height/o.height;return{x:Math.round(g*W),y:Math.round(c*y)}}async function Dt(e){if(!n)return;const{x:o,y:g}=pt(e),c=await n.queryNearestEdge(o,g);t(s)=="3-part-horizontal"&&(c==="top"||c==="bottom")||t(s)=="3-part-vertical"&&(c==="left"||c==="right")||(b=c,await ct(e))}async function ct(e){if(!b||!n)return;const{x:o,y:g}=pt(e),c=await n.getState();b==="left"?t(a).left=Math.max(0,Math.min(o,c.canvasW-1)):b==="right"?t(a).right=Math.max(0,Math.min(c.canvasW-o,c.canvasW-1)):b==="top"?t(a).top=Math.max(0,Math.min(g,c.canvasH-1)):b==="bottom"&&(t(a).bottom=Math.max(0,Math.min(c.canvasH-g,c.canvasH-1))),t(a).left+t(a).right>=c.canvasW&&(t(a).right=Math.max(0,c.canvasW-t(a).left-1)),t(a).top+t(a).bottom>=c.canvasH&&(t(a).bottom=Math.max(0,c.canvasH-t(a).top-1)),await n.setInsets(rt(t(a))),await z()}function ft(){b=!1}async function Ft(){if(!n||!S)return;const e=S,o=await n.exportAsset(e),g=new te,c=g.folder(`${e}.imageset`);c.file(`${e}@3x.png`,o.image3x),c.file(`${e}@2x.png`,o.image2x),c.file(`${e}@1x.png`,o.image1x),c.file("Contents.json",JSON.stringify(o.contents));const W=await g.generateAsync({type:"blob"});ee.saveAs(W,"Demo.zip")}function jt(){return t(s)==="3-part-horizontal"?`
        left:${t(a).left}, right:${t(a).right}
        `:t(s)==="3-part-vertical"?`
        top:${t(a).top}, bottom:${t(a).bottom}
        `:`
    left:${t(a).left}, right:${t(a).right}
    top:${t(a).top}, bottom:${t(a).bottom}
    `}zt(()=>{t(s),t(m),n&&n.setMode(t(s),t(m)).then(async()=>{await z()})});async function R(e,o){n&&(o==="left"?await n.setInsets({left:t(a).left},"right","bottom"):o==="right"?await n.setInsets({right:t(a).right},"left","bottom"):o==="bottom"?await n.setInsets({bottom:t(a).bottom},"right","top"):o==="top"&&await n.setInsets({top:t(a).top},"right","bottom"),w(a,(await n.getState()).insets,!0),await z())}zt(()=>{u.w,u.h,n&&n.getState().then(async()=>{await z()})});let kt=$t(()=>{let e=t(x);return r?r.width*e:1}),Et=$t(()=>{let e=t(x);return r?r.height*e:1});var F=fe(),j=l(h(F),2),k=h(j),Lt=l(h(k));Lt.__change=Nt,v(k);var ut=l(k,2),E=h(ut),A=l(h(E));A.__change=Ot;var L=h(A);L.value=(L.__value=1)==null?"":1;var Y=l(L);Y.value=(Y.__value=2)==null?"":2;var mt=l(Y);mt.value=(mt.__value=3)==null?"":3,v(A),v(E);var q=l(E,2),G=l(h(q)),J=h(G);J.value=(J.__value="9-part")==null?"":"9-part";var T=l(J);T.value=(T.__value="3-part-horizontal")==null?"":"3-part-horizontal";var ht=l(T);ht.value=(ht.__value="3-part-vertical")==null?"":"3-part-vertical",v(G),v(q);var U=l(q,2),X=l(h(U)),Z=h(X);Z.value=(Z.__value="stretch")==null?"":"stretch";var vt=l(Z);vt.value=(vt.__value="tile")==null?"":"tile",v(X),v(U);var Yt=l(U,2);Yt.__click=Ft,v(ut),v(j);var K=l(j,2),M=h(K);let gt;M.__mousedown=Dt,M.__mousemove=ct,M.__mouseup=ft,Ht(M,e=>r=e,()=>r);var Q=l(M,2),qt=h(Q);v(Q);var dt=l(Q,2),V=h(dt),C=l(h(V));$(C),C.__change=[le,R],v(V);var tt=l(V,2),B=l(h(tt));$(B),B.__change=[se,R],v(tt);var et=l(tt,2),N=l(h(et));$(N),N.__change=[pe,R],v(et);var bt=l(et,2),O=l(h(bt));$(O),O.__change=[ce,R],v(bt),v(dt),v(K);var wt=l(K,2),at=l(h(wt),2),it=h(at),xt=l(h(it));$(xt),v(it);var _t=l(it,2),Mt=l(h(_t));$(Mt),v(_t),v(at);var nt=l(at,2);Ht(nt,e=>d=e,()=>d),v(wt),v(F),Xt(e=>{gt=re(M,"image-rendering: crisp-edges; border: 1px solid #ddd; border-radius: 8px;",gt,{width:`${t(kt)??""}px`,height:`${t(Et)??""}px`}),Qt(qt,`insets: ${e??""}`),C.disabled=t(s)=="3-part-vertical",B.disabled=t(s)=="3-part-vertical",N.disabled=t(s)=="3-part-horizontal",O.disabled=t(s)=="3-part-horizontal",It(nt,"width",u.w),It(nt,"height",u.h)},[jt]),ot(A,()=>t(p),e=>w(p,e)),ot(G,()=>t(s),e=>w(s,e)),ot(X,()=>t(m),e=>w(m,e)),Pt("wheel",M,Ct),Pt("mouseleave",M,ft),I(C,()=>t(a).left,e=>t(a).left=e),I(B,()=>t(a).right,e=>t(a).right=e),I(N,()=>t(a).top,e=>t(a).top=e),I(O,()=>t(a).bottom,e=>t(a).bottom=e),I(xt,()=>u.w,e=>u.w=e),I(Mt,()=>u.h,e=>u.h=e),Tt(i,F),Zt()}Vt(["change","click","mousedown","mousemove","mouseup"]);export{ye as component};
