import{t as P,a as T}from"../chunks/CtYR2VL8.js";import"../chunks/DMo5Fuas.js";import{p as J,t as F,c as I,s as x,V as y,K as m,a as O,W as k,ap as q,r as X,T as C}from"../chunks/BiaDghIV.js";import{d as E}from"../chunks/gFQPrapg.js";import{r as H,s as W}from"../chunks/Cgoudy-_.js";import{a as K,b as M,J as U}from"../chunks/Dazn8mIu.js";import{b as Z,s as G}from"../chunks/tOPgWaih.js";import{i as L}from"../chunks/D5r5ET_F.js";function Y(t){const[n,r,i,e]=t;return e>0&&n===0&&r===0&&i===0}function B(t,n){const r=t.width;t.height;const[i,e]=n,s=(e*r+i)*4;if(!(t.data instanceof Uint8ClampedArray)){let o=t.data.subarray(s+0,s+4);return{rgba:[o[0]*255,o[1]*255,o[2]*255,o[3]*255]}}else{let o=t.data.subarray(s+0,s+4);return{rgba:[o[0],o[1],o[2],o[3]]}}}const j=(t,n)=>{const r=[];let i=0;for(;i<t;){for(;i<t&&!n(i);)i++;if(i>=t)break;const e=i;for(;i<t&&n(i);)i++;r.push([e,i])}return r};function Q(t,n){return Y(B(t,[n+1,0]).rgba)}function V(t,n){return Y(B(t,[0,n+1]).rgba)}function D(t,n){return Y(B(t,[n+1,t.height-1]).rgba)}function S(t,n){return Y(B(t,[t.width-1,n+1]).rgba)}function $(t,n,r){const[i,e]=[t.innerWidth,t.innerHeight];if(t.stretchX.length>0&&t.stretchY.length>0){const s=t.stretchX[0],a=t.stretchY[0],[o,h]=[s[0]*n,(i-s[1])*n],[g,f]=[a[0]*n,(e-a[1])*n];return{"cap-insets":{left:o,right:h,bottom:f,top:g},center:{mode:r,width:i*n-o-h,height:e*n-g-f},mode:"9-part"}}else if(t.stretchX.length>0){const s=t.stretchX[0],[a,o]=[s[0]*n,(i-s[1])*n];return{"cap-insets":{left:a,right:o},center:{mode:r,width:i*n-a-o},mode:"3-part-horizontal"}}else if(t.stretchY.length>0){const s=t.stretchY[0],[a,o]=[s[0]*n,(e-s[1])*n];return{"cap-insets":{top:a,bottom:o},center:{mode:r,height:e*n-a-o},mode:"3-part-vertical"}}else return null}function tt(t,n,r,i){console.log("_preprocess_ninepatchInfo","before",t);let e={...t};return e.stretchX.length>0&&(i&&e.stretchX[0][0]==0&&e.stretchX[0][1]==t.innerWidth?e.stretchX=[]:e.stretchX=[e.stretchX[0]]),e.stretchY.length>0&&(r&&e.stretchY[0][0]==0&&e.stretchY[0][1]==t.innerHeight?e.stretchY=[]:e.stretchY=[e.stretchY[0]]),e=structuredClone(e),e.innerHeight/=n,e.innerWidth/=n,e.sourceHeight=e.innerHeight+2,e.sourceWidth=e.innerWidth+2,e.stretchX.forEach(s=>{s[0]/=n,s[1]/=n}),e.stretchY.forEach(s=>{s[0]/=n,s[1]/=n}),e.content.top/=n,e.content.bottom/=n,e.content.left/=n,e.content.right/=n,console.log("_preprocess_ninepatchInfo","after",e),e}function et(t,n,r,i="stretch",e=!0,s=!0){const a=tt(n,r,e,s),o=$(a,1,i),h=$(a,2,i),g=$(a,3,i);return console.log(a,o,h,g),{images:[{filename:`${t}@1x.png`,idiom:"universal",scale:"1x",resizing:o!==null?o:void 0},{filename:`${t}@2x.png`,idiom:"universal",scale:"2x",resizing:h!==null?h:void 0},{filename:`${t}@3x.png`,idiom:"universal",scale:"3x",resizing:g!==null?g:void 0}],info:{version:1,author:"pbk"}}}function nt(t){const n=t.width,r=t.height;if(n<3||r<3)return null;const i=n-2,e=r-2,s=j(i,l=>Q(t,l)),a=j(e,l=>V(t,l)),o=j(i,l=>D(t,l)),h=j(e,l=>S(t,l));if(s.length===0&&a.length===0)return null;const g=o.length?o[0]:[0,i],f=h.length?h[0]:[0,e];return{sourceWidth:n,sourceHeight:r,innerWidth:i,innerHeight:e,stretchX:s,stretchY:a,content:{left:g[0],right:i-g[1],top:f[0],bottom:e-f[1]}}}function it(t){return t.replace(/\.9\.png$/i,"").replace(/\.png$/i,"")||"Image"}async function ot(t,n,r,i,e,s){const a=t.currentTarget.files;if(!a||a.length<1)return;const o=new U;async function h(l){const b=n(l.name),v=await createImageBitmap(l).then(u=>{let c=new OffscreenCanvas(u.width,u.height),_=c.getContext("2d",{willReadFrequently:!0});_.drawImage(u,0,0);let d=_.getImageData(0,0,c.width,c.height),p=nt(d);if(console.log(p),p){let w=_.getImageData(1,1,c.width-1,c.height-1);return u.close(),{contentImage:w,patchInfo:p}}u.close()});if(v){let u=et(b,v.patchInfo,m(r),m(i),m(e),m(s));console.log(u);const[c,_]=[v.contentImage.width/m(r),v.contentImage.height/m(r)],d=new OffscreenCanvas(c*3,_*3),p=await createImageBitmap(v.contentImage);let w=d.getContext("2d");w.drawImage(p,0,0,c*3,_*3);let R=await d.convertToBlob({type:"image/png"});d.width=c*2,d.height=_*2,w=d.getContext("2d"),w.drawImage(p,0,0,c*2,_*2);let A=await d.convertToBlob({type:"image/png"});d.width=c,d.height=_,w=d.getContext("2d"),w.drawImage(p,0,0,c,_);let N=await d.convertToBlob({type:"image/png"});p.close();let z=o.folder(`${b}.imageset`);z.file(`${b}@3x.png`,R),z.file(`${b}@2x.png`,A),z.file(`${b}@1x.png`,N),z.file("Contents.json",JSON.stringify(u))}}let g=Array.from(a).map(l=>h(l));await Promise.all(g);const f=await o.generateAsync({type:"blob"});G(f,"NinePatch-imagesets.zip")}var st=P('<div class="container svelte-whsjza"><label for="nine_patch_source_scale" class="svelte-whsjza">source scale</label> <input id="nine_patch_source_scale" type="number" min="1" class="svelte-whsjza"> <label for="nine_patch_content_mode" class="svelte-whsjza">content mode</label> <select id="nine_patch_content_mode" class="svelte-whsjza"><option>stretch</option><option>tile</option></select> <div class="checkbox-row svelte-whsjza"><input id="nine_patch_translate_for_horizontalMode" type="checkbox"> <label for="nine_patch_translate_for_horizontalMode" class="svelte-whsjza">convert to 3-part-horizontal slice if possible</label></div> <div class="checkbox-row svelte-whsjza"><input id="nine_patch_translate_for_verticalMode" type="checkbox"> <label for="nine_patch_translate_for_verticalMode" class="svelte-whsjza">convert to 3-part-vertical slice if possible</label></div> <label for="nine_patch_images" class="svelte-whsjza">Android nine-patch source png</label> <input type="file" id="nine_patch_images" name="images" multiple accept=".9.png" class="svelte-whsjza"> <ul class="svelte-whsjza"><li>requires valid .9.png format android nine-patch png file</li> <li>content-padding and optical bind are ignored</li> <li>only first stretch region is recognized</li> <li>source png divided by source scale will be the 1x scale</li> <li>mdpi → 1x, xhdpi → 2x, xxhdpi → 3x, xxxhdpi → 4x</li></ul></div>');function ft(t,n){J(n,!1);let r=y(3),i=y("stretch"),e=y(!0),s=y(!0);const a={translate_for_horizontalMode:`
      transform nine-patch images into 3-part-horizontal resizing if the nine-patch region is like below

      ----------------
      |       |          |     |
      |       |          |     |
      |       |          |     |
      |       |          |     |
      |       |          |     |
      |       |          |     |
      ----------------
      `,translate_for_verticalMode:`
      transform nine-patch images into 3-part-vertical resizing if the nine-patch region is like below
      ----------------
      |                         |
      |                         |
      ----------------
      |                         |
      |                         |
      ----------------
      |                         |
      |                         |
      ----------------
      `,nine_patch_source_scale:`
      pick 1 for mdpi
      pick 2 for xhdpi
      pick 3 for xxhdpi
      pick 4 for xxxhdpi
      `};L();var o=st(),h=I(o),g=x(h,2);H(g);var f=x(g,4);F(()=>{m(i),q(()=>{})});var l=I(f);l.value=(l.__value="stretch")==null?"":"stretch";var b=x(l);b.value=(b.__value="tile")==null?"":"tile",X(f);var v=x(f,2),u=I(v);H(u),C(2),X(v);var c=x(v,2),_=I(c);H(_),C(2),X(c);var d=x(c,4);d.__change=[ot,it,r,i,e,s],C(2),X(o),F(()=>{W(h,"title",a.nine_patch_source_scale),W(v,"title",a.translate_for_horizontalMode),W(c,"title",a.translate_for_verticalMode)}),K(g,()=>m(r),p=>k(r,p)),Z(f,()=>m(i),p=>k(i,p)),M(u,()=>m(e),p=>k(e,p)),M(_,()=>m(s),p=>k(s,p)),T(t,o),O()}E(["change"]);export{ft as component};
