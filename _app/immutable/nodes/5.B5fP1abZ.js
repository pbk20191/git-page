import{t as N,a as P}from"../chunks/C40Lt10h.js";import"../chunks/DS3FZYJ0.js";import{p as J,t as M,c as y,s as x,O as z,C as _,a as O,P as X,al as T,r as j,M as C}from"../chunks/DDedSiM2.js";import{d as q}from"../chunks/B0CZYdza.js";import{r as H}from"../chunks/B1B_G-Wy.js";import{a as E,b as W,J as U}from"../chunks/Cg_NRMVG.js";import{b as Z,s as G}from"../chunks/Bk6w-FME.js";import{i as K}from"../chunks/ZgGQqpiK.js";function k(t){const[n,r,i,e]=t;return e>0&&n===0&&r===0&&i===0}function B(t,n){const r=t.width;t.height;const[i,e]=n,o=(e*r+i)*4;if(!(t.data instanceof Uint8ClampedArray)){let s=t.data.subarray(o+0,o+4);return{rgba:[s[0]*255,s[1]*255,s[2]*255,s[3]*255]}}else{let s=t.data.subarray(o+0,o+4);return{rgba:[s[0],s[1],s[2],s[3]]}}}const Y=(t,n)=>{const r=[];let i=0;for(;i<t;){for(;i<t&&!n(i);)i++;if(i>=t)break;const e=i;for(;i<t&&n(i);)i++;r.push([e,i])}return r};function L(t,n){return k(B(t,[n+1,0]).rgba)}function Q(t,n){return k(B(t,[0,n+1]).rgba)}function V(t,n){return k(B(t,[n+1,t.height-1]).rgba)}function D(t,n){return k(B(t,[t.width-1,n+1]).rgba)}function $(t,n,r){const[i,e]=[t.innerWidth,t.innerHeight];if(t.stretchX.length>0&&t.stretchY.length>0){const o=t.stretchX[0],a=t.stretchY[0],[s,l]=[o[0]*n,(i-o[1])*n],[p,f]=[a[0]*n,(e-a[1])*n];return{"cap-insets":{left:s,right:l,bottom:f,top:p},center:{mode:r,width:i*n-s-l,height:e*n-p-f},mode:"9-part"}}else if(t.stretchX.length>0){const o=t.stretchX[0],[a,s]=[o[0]*n,(i-o[1])*n];return{"cap-insets":{left:a,right:s},center:{mode:r,width:i*n-a-s},mode:"3-part-horizontal"}}else if(t.stretchY.length>0){const o=t.stretchY[0],[a,s]=[o[0]*n,(e-o[1])*n];return{"cap-insets":{top:a,bottom:s},center:{mode:r,height:e*n-a-s},mode:"3-part-vertical"}}else return null}function S(t,n,r,i){console.log("_preprocess_ninepatchInfo","before",t);let e={...t};return e.stretchX.length>0&&(i&&e.stretchX[0][0]==0&&e.stretchX[0][1]==t.innerWidth?e.stretchX=[]:e.stretchX=[e.stretchX[0]]),e.stretchY.length>0&&(r&&e.stretchY[0][0]==0&&e.stretchY[0][1]==t.innerHeight?e.stretchY=[]:e.stretchY=[e.stretchY[0]]),e=structuredClone(e),e.innerHeight/=n,e.innerWidth/=n,e.sourceHeight=e.innerHeight+2,e.sourceWidth=e.innerWidth+2,e.stretchX.forEach(o=>{o[0]/=n,o[1]/=n}),e.stretchY.forEach(o=>{o[0]/=n,o[1]/=n}),e.content.top/=n,e.content.bottom/=n,e.content.left/=n,e.content.right/=n,console.log("_preprocess_ninepatchInfo","after",e),e}function tt(t,n,r,i="stretch",e=!0,o=!0){const a=S(n,r,e,o),s=$(a,1,i),l=$(a,2,i),p=$(a,3,i);return console.log(a,s,l,p),{images:[{filename:`${t}@1x.png`,idiom:"universal",scale:"1x",resizing:s!==null?s:void 0},{filename:`${t}@2x.png`,idiom:"universal",scale:"2x",resizing:l!==null?l:void 0},{filename:`${t}@3x.png`,idiom:"universal",scale:"3x",resizing:p!==null?p:void 0}],info:{version:1,author:"pbk"}}}function et(t){const n=t.width,r=t.height;if(n<3||r<3)return null;const i=n-2,e=r-2,o=Y(i,h=>L(t,h)),a=Y(e,h=>Q(t,h)),s=Y(i,h=>V(t,h)),l=Y(e,h=>D(t,h));if(o.length===0&&a.length===0)return null;const p=s.length?s[0]:[0,i],f=l.length?l[0]:[0,e];return{sourceWidth:n,sourceHeight:r,innerWidth:i,innerHeight:e,stretchX:o,stretchY:a,content:{left:p[0],right:i-p[1],top:f[0],bottom:e-f[1]}}}function nt(t){return t.replace(/\.9\.png$/i,"").replace(/\.png$/i,"")||"Image"}async function it(t,n,r,i,e,o){const a=t.currentTarget.files;if(!a||a.length<1)return;const s=new U;async function l(h){const m=n(h.name),v=await createImageBitmap(h).then(u=>{let g=new OffscreenCanvas(u.width,u.height),c=g.getContext("2d",{willReadFrequently:!0});c.drawImage(u,0,0);let d=c.getImageData(0,0,g.width,g.height),b=et(d);if(b){let w=c.getImageData(1,1,g.width-1,g.height-1);return u.close(),{contentImage:w,patchInfo:b}}u.close()});if(v){let u=tt(m,v.patchInfo,_(r),_(i),_(e),_(o));console.log(u);const[g,c]=[v.contentImage.width/_(r),v.contentImage.height/_(r)],d=new OffscreenCanvas(g*3,c*3),b=await createImageBitmap(v.contentImage);let w=d.getContext("2d");w.drawImage(b,0,0,g*3,c*3);let F=await d.convertToBlob({type:"image/png"});d.width=g*2,d.height=c*2,w=d.getContext("2d"),w.drawImage(b,0,0,g*2,c*2);let R=await d.convertToBlob({type:"image/png"});d.width=g,d.height=c,w=d.getContext("2d"),w.drawImage(b,0,0,g,c);let A=await d.convertToBlob({type:"image/png"});b.close();let I=s.folder(`${m}.imageset`);I.file(`${m}@3x.png`,F),I.file(`${m}@2x.png`,R),I.file(`${m}@1x.png`,A),I.file("Contents.json",JSON.stringify(u))}}let p=Array.from(a).map(h=>l(h));await Promise.all(p);const f=await s.generateAsync({type:"blob"});G(f,"NinePatch-imagesets.zip")}var st=N('<div class="container svelte-whsjza"><label for="nine_patch_source_scale" class="svelte-whsjza">source scale</label> <input id="nine_patch_source_scale" type="number" min="1" class="svelte-whsjza"> <label for="nine_patch_content_mode" class="svelte-whsjza">content mode</label> <select id="nine_patch_content_mode" class="svelte-whsjza"><option>stretch</option><option>tile</option></select> <div class="checkbox-row svelte-whsjza"><input id="nine_patch_translate_for_horizontalMode" type="checkbox"> <label for="nine_patch_translate_for_horizontalMode" class="svelte-whsjza">convert to 3-part-horizontal slice if possible</label></div> <div class="checkbox-row svelte-whsjza"><input id="nine_patch_translate_for_verticalMode" type="checkbox"> <label for="nine_patch_translate_for_verticalMode" class="svelte-whsjza">convert to 3-part-vertical slice if possible</label></div> <label for="nine_patch_images" class="svelte-whsjza">Android nine-patch source png</label> <input type="file" id="nine_patch_images" name="images" multiple accept=".9.png" class="svelte-whsjza"> <ul class="svelte-whsjza"><li>requires valid .9.png format android nine-patch png file</li> <li>content-padding and optical bind are ignored</li> <li>only first stretch region is recognized</li> <li>source png divided by source scale will be the 1x scale</li> <li>mdpi → 1x, xhdpi → 2x, xxhdpi → 3x, xxxhdpi → 4x</li></ul></div>');function dt(t,n){J(n,!1);let r=z(3),i=z("stretch"),e=z(!0),o=z(!0);K();var a=st(),s=x(y(a),2);H(s);var l=x(s,4);M(()=>{_(i),T(()=>{})});var p=y(l);p.value=(p.__value="stretch")==null?"":"stretch";var f=x(p);f.value=(f.__value="tile")==null?"":"tile",j(l);var h=x(l,2),m=y(h);H(m),C(2),j(h);var v=x(h,2),u=y(v);H(u),C(2),j(v);var g=x(v,4);g.__change=[it,nt,r,i,e,o],C(2),j(a),E(s,()=>_(r),c=>X(r,c)),Z(l,()=>_(i),c=>X(i,c)),W(m,()=>_(e),c=>X(e,c)),W(u,()=>_(o),c=>X(o,c)),P(t,a),O()}q(["change"]);export{dt as component};
